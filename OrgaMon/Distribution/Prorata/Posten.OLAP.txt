SELECT
 GELIEFERT.MENGE_RECHNUNG MENGE_GELIEFERT,
 GELIEFERT.MWST,
 COALESCE(PRORATA.WERT,GELIEFERT.PREIS) as PREIS,
 GELIEFERT.RABATT,
 GELIEFERT.ARTIKEL_R,
 GELIEFERT.AUSGABEART_R,
 GELIEFERT.EINHEIT_R,
 GELIEFERT.BELEG_R,
 GELIEFERT.ARTIKEL,
 GELIEFERT.ZUSAGE
FROM
 GELIEFERT
join
 PRORATA
on
 (PRORATA.AUSGABEART_R is NULL) and
 (PRORATA.ARTIKEL_R=GELIEFERT.ARTIKEL_R)
WHERE
 (BELEG_R=:CROSSREF) and
 (GELIEFERT.ARTIKEL_R IS NOT NULL) and
 (GELIEFERT.AUSGABEART_R IS NULL) and
 (GELIEFERT.PREIS is not null) and
 (GELIEFERT.MENGE_RECHNUNG is not null)