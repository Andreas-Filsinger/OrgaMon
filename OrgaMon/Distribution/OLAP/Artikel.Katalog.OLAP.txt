--
--  O L A P  - Definitions Datei
--

$Verlage=548
$Sortimente=65580
$Context=2

select distinct
 ARTIKEL.RID KOLLEKTION_R
from
 ARTIKEL
join
 ARTIKEL_MITGLIED 
on
 (ARTIKEL.RID=ARTIKEL_MITGLIED.MASTER_R) and
 (ARTIKEL_MITGLIED.CONTEXT_R=$Context)
where
 (ARTIKEL.SORTIMENT_R in ($Sortimente)) and
 (ARTIKEL.VERLAG_R in ($Verlage))    


save

numeric KOLLEKTION_R 

repeat

select 
 'Y' as KOLLEKTION,
 '$RID' as MASTER_R,
 '$RID' as ARTIKEL_R,
 '0' as POSNO,
 ARTIKEL.KOMPONIST_R,
 ARTIKEL.ARRANGEUR_R,
 ARTIKEL.NUMERO,
 ARTIKEL.TITEL
from
 ARTIKEL
where 
 (ARTIKEL.RID=$RID)
~  
select 
 'N' as KOLLEKTION,
 '$RID' as MASTER_R,
 ARTIKEL_MITGLIED.ARTIKEL_R,
 ARTIKEL_MITGLIED.POSNO,
 ARTIKEL.KOMPONIST_R,
 ARTIKEL.ARRANGEUR_R,
 ARTIKEL.NUMERO,
 COALESCE( ARTIKEL_MITGLIED.TITEL, ARTIKEL.TITEL ) TITEL
from
 ARTIKEL_MITGLIED
left join 
 ARTIKEL
on
 (ARTIKEL.RID=ARTIKEL_MITGLIED.ARTIKEL_R) 
where 
 (ARTIKEL_MITGLIED.MASTER_R=$RID) and
 (ARTIKEL_MITGLIED.CONTEXT_R=$Context)
order by
 ARTIKEL_MITGLIED.POSNO, ARTIKEL_MITGLIED.RID
-   

complete

Bild(ARTIKEL_R) BILD
Vorschau(ARTIKEL_R) VORSCHAU
Preis(ARTIKEL_R) PREIS as Betrag
"("||KomponistN(KOMPONIST_R)||"/"||ArrangeurN(ARRANGEUR_R)||")" KOMPONIST_ARRANGEUR
-

story

Anker=MASTER_R
Erzähle=TITEL;KOMPONIST_ARRANGEUR;PREIS
-
 
excel

open
- 